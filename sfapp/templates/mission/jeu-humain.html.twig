{% extends 'base.html.twig' %}

{% block title %}Jeu de Memory{% endblock %}

{% block body %}

    <style>
        /* Style basique */
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #233059;
        }

        .draggable {
            margin: 10px;
            padding: 15px;
            border-radius: 25%;
            background-color: lightblue;
            width: 150px;
            cursor: pointer;
            display: inline-block;
            border: 3px solid white;
        }

        .dropzone {
            width: 250px;
            height: 200px;
            margin: 20px;
            padding: 10px;
            border: 2px dashed gray;
            display: inline-block;
            vertical-align: top;
        }



        #result {
            margin-top: 20px;
            font-size: 18px;
            font-weight: bold;
            text-shadow: 1px 1px 1px grey;
        }
    </style>

    <h1 style="position: absolute; top: 20px; left: 20px;font-size: 2rem; color: white">10M</h1>

    <div style="display: flex; width: 100%; justify-content: center;padding-top: 20px;">
        <a  href="{{ path('app_accueil') }}" style="width: 40%"><img src="{{ asset('styles/logo.png') }}" style="width: 100%;" alt="Image"></a>
    </div>
    <img src="{{ asset('styles/VagueBlanc.png') }}" style="width: 100%;" alt="Image">

    <div style="display: inline">
        <div class="draggable" id="text1" draggable="true" ondragstart="drag(event)">
            Phytoplancton
        </div>
        <div class="draggable" id="text2" draggable="true" ondragstart="drag(event)">
            Les courants Marins
        </div>
        <div class="draggable" id="text3" draggable="true" ondragstart="drag(event)">
            Les océans
        </div>
    </div>

    <div style="display: flex; justify-content: center; align-items: center; padding-top: 0%;">


        <!-- Zone de dépôt à gauche -->
        <div class="dropzone" style="background-color: #93c5fd; padding: 20px; margin-right: 20px;" id="case1" ondrop="drop(event)" ondragover="allowDrop(event)">
            Poumons
        </div>

        <!-- Image centrée -->
        <img src="{{ asset('styles/man.png') }}" style="width: 40%;" alt="Image">

        <!-- Conteneur des zones de dépôt à droite -->
        <div style="display: flex; flex-direction: column; align-items: flex-start; margin-left: 20px;">
            <!-- Zone de dépôt droite (première ligne) -->
            <div class="dropzone" style="background-color: #93c5fd; padding: 20px; margin-bottom: 10px;" id="case2" ondrop="drop(event)" ondragover="allowDrop(event)">
                Coeur
            </div>

            <!-- Zone de dépôt droite (deuxième ligne) -->
            <div class="dropzone" style="background-color: #93c5fd; padding: 20px;" id="case3" ondrop="drop(event)" ondragover="allowDrop(event)">
                L'humain
            </div>
        </div>

    </div>

    <!-- Zone pour afficher le message de résultat -->
    <div id="result"></div>

    <script>
        var correctDrops = {
            case1: false,
            case2: false,
            case3: false
        };

        function allowDrop(event) {
            event.preventDefault(); // Permet le dépôt de l'élément en empêchant le comportement par défaut
        }

        function drag(event) {
            event.dataTransfer.setData("text", event.target.id); // Définir l'ID de l'élément à déplacer
        }

        function drop(event) {
            event.preventDefault(); // Empêcher le comportement par défaut lors du dépôt
            var data = event.dataTransfer.getData("text");
            var draggedElement = document.getElementById(data);
            var targetCase = event.target;

            // Vérifier si le texte déposé correspond à la bonne zone
            if (targetCase.id === "case1" && draggedElement.id === "text1") {
                targetCase.appendChild(draggedElement); // Déposer l'élément dans la case correcte
                showResult("Correct ! Texte 1 est dans la bonne case.", true, targetCase.id);
            } else if (targetCase.id === "case2" && draggedElement.id === "text2") {
                targetCase.appendChild(draggedElement); // Déposer l'élément dans la case correcte
                showResult("Correct ! Texte 2 est dans la bonne case.", true, targetCase.id);
            } else if (targetCase.id === "case3" && draggedElement.id === "text3") {
                targetCase.appendChild(draggedElement); // Déposer l'élément dans la case correcte
                showResult("Correct ! Texte 3 est dans la bonne case.", true, targetCase.id);
            } else {
                targetCase.appendChild(draggedElement); // Déposer l'élément mais c'est incorrect
                showResult("Mauvais placement ! Essayez encore.", false, targetCase.id);
            }
        }

        function showResult(message, isCorrect, caseId) {
            const resultDiv = document.getElementById("result");
            resultDiv.innerText = message; // Afficher le message dans la zone de résultat

            // Changer la couleur du message en fonction de la validité de la réponse
            if (isCorrect) {
                resultDiv.style.color = "lightgreen"; // Correct => vert
                correctDrops[caseId] = true; // Marquer cette case comme correctement remplie
            } else {
                resultDiv.style.color = "red"; // Incorrect => rouge
                correctDrops[caseId] = false; // Marquer cette case comme incorrecte
            }

            // Vérifier si toutes les zones sont correctement remplies
            if (correctDrops.case1 && correctDrops.case2 && correctDrops.case3) {
                setTimeout(function() {
                    window.location.href = "{{ path('app_mission_human_gagner') }}"; // Redirection vers la route 'app_parcours'
                }, 1000); // Redirection après 1 seconde pour laisser le temps de voir le message
            }
        }
    </script>

{% endblock %}
