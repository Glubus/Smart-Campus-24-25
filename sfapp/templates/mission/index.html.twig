{% extends 'base.html.twig' %}

{% block title %}Hello MissionController!{% endblock %}

{% block body %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animation avec Changement d'Image</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            position: relative;
            height: 100vh;
        }

        #movingElement {
            width: 50px;
            height: 50px;
            position: absolute;
            top: 0;
            left: 0;
            border-radius: 50%;
        }

        #movingElement img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
        }
    </style>
</head>
<body>
    <div id="movingElement"></div>

    <script>
        let aa = false;
        const element = document.getElementById('movingElement');
        const elementSize = 50;
        let posX = 1;
        let posY = 1;
        let velocityX = 1;
        let velocityY = 0;
        let isMouseOver = false;
        let currentScale = 1;

        // Fonction pour gérer l'affichage de l'image
        function updateImage() {
            if (!aa) {
                element.innerHTML = '<img src="{{ asset('media/poisson.jpeg') }}" alt="Poisson">';
            } else {
                element.innerHTML = '<img src="{{ asset('media/logo.jpg') }}" alt="Logo">';
            }
        }

        // Fonction pour animer l'élément
        function animate() {
            // Mise à jour des positions
            posX += velocityX;
            posY += velocityY;

            // Détection des collisions avec les bords
            if (posX <= 0) {
                velocityY = -Math.abs(velocityX);
                posX = 0;
            }
            if (posX + elementSize >= window.innerWidth) {
                velocityY = Math.abs(velocityX);
                posX = window.innerWidth - elementSize;
            }
            if (posY <= 0) {
                velocityX = Math.abs(velocityY);
                posY = 0;
            }
            if (posY + elementSize >= window.innerHeight) {
                velocityX = -Math.abs(velocityY);
                posY = window.innerHeight - elementSize;
            }

            // Appliquer les nouvelles positions
            element.style.left = posX + 'px';
            element.style.top = posY + 'px';

            // Agrandir l'élément si la souris est dessus
            if (isMouseOver) {
                currentScale += 0.02;
                element.style.transform = `scale(${currentScale})`;
            }

            // Boucle de l'animation
            requestAnimationFrame(animate);
        }

        // Détection de la souris sur l'élément
        element.addEventListener('mouseenter', () => {
            isMouseOver = true;
        });

        element.addEventListener('mouseleave', () => {
            isMouseOver = false;
            currentScale = 1;
            element.style.transform = 'scale(1)';
        });

        // Gestion du clic
        element.addEventListener('click', () => {
            aa = true; // Change la variable
            updateImage(); // Met à jour immédiatement l'image
        });

        // Initialisation
        updateImage(); // Affiche l'image initiale
        animate(); // Démarre l'animation
    </script>
</body>
</html>


<style>
    .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
    .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
</style>

<div class="example-wrapper">
    <h1>Hello {{ controller_name }}! ✅</h1>

    This friendly message is coming from:
    <ul>
        <li>Your controller at <code>/app/sfapp/src/Controller/MissionController.php</code></li>
        <li>Your template at <code>/app/sfapp/templates/mission/index.html.twig</code></li>
        <div class=movingElement>
        </div>
    </ul>
</div>
{% endblock %}
